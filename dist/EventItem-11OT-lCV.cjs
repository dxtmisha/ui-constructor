"use strict";var c=Object.defineProperty;var u=(i,t,e)=>t in i?c(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var n=(i,t,e)=>(u(i,typeof t!="symbol"?t+"":t,e),e);const r=require("./getElement-BOMHgffA.cjs"),v=require("./DataStorage-CrDkIbGp.cjs"),l=require("./toArray-h-YFi-Q9.cjs");function o(i){return r.isWindow(i)?i:r.getElement(i)}function m(i){var t;return!!((t=r.getElement(i))!=null&&t.closest("html"))}class E{constructor(t,e=["click"],s,h,a){n(this,"element");n(this,"elementControl");n(this,"elementControlEdit");n(this,"type");n(this,"listenerRecent",t=>{var e,s;m(this.elementControl)?((e=this.listener)==null||e.call(this.element,t,this.detail),l.isObject(this.options)&&((s=this.options)!=null&&s.once)&&this.stop()):this.stop()});n(this,"activity",!1);n(this,"activityItems",[]);this.listener=s,this.options=h,this.detail=a,this.element=o(t),this.elementControl=r.getElement(t),this.type=l.toArray(e)}isActive(){return this.activity}setElement(t){const e=o(t);return this.elementControlEdit||(this.elementControl=r.getElement(t)),this.element=e,this.reset(),this}setElementControl(t){return this.elementControl=r.getElement(t),this.elementControlEdit=!v.isNull(this.elementControl),this.elementControlEdit||(this.elementControl=r.getElement(this.element)),this}setType(t){return this.type=l.toArray(t),this.reset(),this}setListener(t){return this.listener=t,this}setOptions(t){return this.options=t,this.reset(),this}setDetail(t){return this.detail=t,this}dispatch(t=this.detail){return this.type.forEach(e=>{var s;return(s=this.element)==null?void 0:s.dispatchEvent(new CustomEvent(e,{detail:t}))}),this}start(){return this.activity||(this.activity=!0,this.activityItems=[],this.type.forEach(t=>{this.element&&!(t==="resize"&&this.makeResize())&&!(t==="scroll-sync"&&this.makeScroll())&&(this.element.addEventListener(t,this.listenerRecent,this.options),this.activityItems.push({element:this.element,type:t}))})),this}stop(){return this.activity&&(this.activity=!1,this.activityItems.forEach(({element:t,type:e,listener:s,observer:h})=>{h?h.disconnect():s?t==null||t.removeEventListener(e,s):t==null||t.removeEventListener(e,this.listenerRecent)})),this}toggle(t){return t?this.start():this.stop()}reset(){return this.activity&&(this.stop(),this.start()),this}isObserver(){return"ResizeObserver"in window}makeResize(){if(this.element&&this.element instanceof HTMLElement&&this.element!==document.body&&this.isObserver()){const t=new ResizeObserver(e=>this.listenerRecent(e==null?void 0:e[0]));return t.observe(this.element),this.activityItems.push({element:this.element,type:"resize",observer:t}),!0}return!1}makeScroll(){if(this.element){let t=!1;const e=s=>{t||(t=!0,requestAnimationFrame(()=>{this.listenerRecent(s),t=!1}))};return this.element.addEventListener("scroll",e,this.options),this.element.addEventListener("resize",e,this.options),this.activityItems.push({element:this.element,type:"scroll",listener:e},{element:this.element,type:"resize",listener:e}),!0}return!1}}exports.EventItem=E;exports.getElementOrWindow=o;exports.isInDom=m;
