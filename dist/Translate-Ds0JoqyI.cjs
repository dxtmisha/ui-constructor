"use strict";var f=Object.defineProperty;var N=(h,t,s)=>t in h?f(h,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[t]=s;var c=(h,t,s)=>(N(h,typeof t!="symbol"?t+"":t,s),s);const u=require("./toArray-h-YFi-Q9.cjs"),l=require("./isFilled-BySHTEb1.cjs"),d=require("./Geo-VVc_JzGu.cjs"),o=require("./Api-Cbr6rjXD.cjs"),m=require("./DataStorage-AmPehfI-.cjs"),e=class e{static async get(t){var i;const s=this.getName(t);return s in this.data?this.data[s]:(o.Api.isLocalhost()||await this.add(t),((i=this.data)==null?void 0:i[s])??t)}static getSync(t,s=!1){const i=this.getName(t);return i in this.data?this.data[i]:s?" ":t}static getList(t){return new Promise(s=>{const i={};let a=0;for(const n of t)this.get(n).then(g=>{i[n]=g,++a>=t.length&&s(i)})})}static getListSync(t,s=!1){const i={};for(const a of t)i[a]=this.getSync(a,s);return i}static add(t){return new Promise(s=>{this.getNamesNone(t).length>0?(this.cache.push(...this.getNamesNone(t)),this.resolveList.push(s),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.timeout=void 0,this.make().then(()=>{this.resolveList.forEach(a=>a()),this.resolveList=[]})},160)):s()})}static addSync(t){u.forEach(t,(s,i)=>{d.isString(s)&&l.isFilled(s)&&(this.data[this.getName(i)]=s)})}static async addNormalOrSync(t){if(l.isFilled(t))if(o.Api.isLocalhost())this.addSync(t);else{const s=Object.keys(t);s.length>0&&await this.add(s)}}static setUrl(t){return this.url=t,e}static getName(t){return`${d.Geo.getLocation()}-${t}`}static getNamesNone(t){const s=[];return u.toArray(t).forEach(i=>{i!=="__TRANSLATE_START__"&&i!=="__TRANSLATE_END__"&&!(this.getName(i)in this.data)&&s.push(i)}),s}static async getResponse(){const t=await o.Api.get({api:!1,path:this.url,request:{list:this.cache},global:!0});return(t==null?void 0:t.data)??{}}static async make(){const t=await this.getResponse();this.cache.forEach(s=>{this.data[this.getName(s)]=(t==null?void 0:t[s])??""}),this.cache=[]}};c(e,"url",m.useEnv("apiTranslate")),c(e,"data",{}),c(e,"cache",[]),c(e,"resolveList",[]),c(e,"timeout");let r=e;exports.Translate=r;
