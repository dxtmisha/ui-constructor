"use strict";var p=Object.defineProperty;var D=(c,t,e)=>t in c?p(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e;var h=(c,t,e)=>(D(c,typeof t!="symbol"?t+"":t,e),e);const b=require("./DataStorage-Bad5dLlo.cjs"),d=require("./toNumber-cBi38xJ6.cjs"),y=require("./Geo-DKCn6cDx.cjs");class ${constructor(t){h(this,"cache");h(this,"comparisons",[]);this.callback=t}getCache(t){return this.isUpdate(t)&&this.setCache(),this.cache}async getCacheAsync(t){return this.isUpdate(t)&&await this.setCacheAsync(),this.cache}setCache(){this.cache=this.callback()}async setCacheAsync(){this.cache=await this.callback()}isUpdate(t){return this.cache===void 0||this.comparisons.length!==t.length||this.comparisons.findIndex((e,n)=>e!==t[n])>=0?(this.comparisons=[...t],!0):!1}}function u(c){if(c instanceof Date)return c;if(b.isNull(c))return new Date;if(typeof c=="number")return new Date(c);let t=c,e="";c.replace(/^([\s\S]+)([-+]\d{2}:?\d{2})$/,(r,a,i)=>(t=a,e=i,r));const n=(/^\d{4}\d{2}\d{2}$/.exec(t)&&`${t.replace(/^(\d{4})(\d{2})(\d{2})$/,"$1-$2-$3")}T00:00:00`)??(/^\d{4}\d{2}$/.exec(t)&&`${t.replace(/^(\d{4})(\d{2})$/,"$1-$2")}-01T00:00:00`)??(/^\d{4}-\d{2}-\d{2}$/.exec(t)&&`${t}T00:00:00`)??(/^\d{4}-\d{2}$/.exec(t)&&`${t}-01T00:00:00`)??(/^\d{4}$/.exec(t)&&`${t}-01-01T00:00:00`)??(/^\d{2}:\d{2}$/.exec(t)&&`2000-01-01T${t}:00`)??(/^\d{2}:\d{2}:\d{2}$/.exec(t)&&`2000-01-01T${t}`)??t.replace(" ","T");return new Date(`${n}${e}`)}class w{constructor(t=y.Geo.getLocation()){h(this,"geo");this.geo=y.Geo.find(t);const e=this.getLocation();if(e in m)return m[e];m[e]=this}getLocation(){return this.geo.standard}getFirstDay(){return this.geo.firstDay}display(t,e){let n={type:"language"},r;e&&(typeof e=="string"?n.type=e:n={...n,...e});try{t?r=new Intl.DisplayNames(this.getLocation(),n).of(t):n.type==="language"?r=new Intl.DisplayNames(this.getLocation(),n).of(this.geo.language):n.type==="region"&&(r=new Intl.DisplayNames(this.getLocation(),n).of(this.geo.country))}catch{}return r??t??""}languageName(t,e){const n={type:"language",style:e};return this.display(t,n)}countryName(t,e){const n={type:"region",style:e};return this.display(t,n)}number(t,e){var n,r;return((r=(n=this.numberObject(e))==null?void 0:n.format)==null?void 0:r.call(n,d.toNumber(t)))||t.toString()}decimal(){var t,e,n,r,a;return((a=(r=(n=(e=(t=this.numberObject())==null?void 0:t.formatToParts)==null?void 0:e.call(t,1.2))==null?void 0:n.find)==null?void 0:r.call(n,i=>i.type==="decimal"))==null?void 0:a.value)||"."}currency(t,e,n=!1){const r={style:"currency",currencyDisplay:"symbol",...typeof e=="string"?{currency:e}:e||{}},a=t.toString().replace(/^([\S\s]+[\d ])([a-zA-Z]{3})$/i,(...i)=>(r.currency=i[2].toUpperCase(),i[1]));if(n){const i=this.numberObject(r);return i?i.formatToParts(d.toNumber(t)).filter(o=>["literal","currency"].indexOf(o.type)===-1).join(""):t.toString()}else return this.number(a,r)}unit(t,e){const n={style:"unit",...typeof e=="string"?{unit:e}:e||{}},r=t.toString().replace(/^([\S\s]+[\d ])([a-zA-Z]+)$/i,(...a)=>(n.unit=a[2].toLowerCase(),a[1]));return this.number(r,n)}percent(t,e){return this.number(t,{style:"percent",...e||{}})}percentBy100(t,e){return this.percent(d.toNumber(t)/100,e)}date(t,e,n,r){const a=u(t),i=typeof n=="string",o=this.dateOptions(e,i?n:"short");return r&&(o.hour12=!1),i||Object.assign(o,n),a.toLocaleString(this.getLocation(),o)}relative(t,e,n){const r=u(t),a=n||new Date,i={numeric:"auto",...typeof e=="string"?{style:e}:e||{}};let o="second",s=(r.getTime()-a.getTime())/1e3;Math.abs(s)>=60&&(o="minute",s/=60,Math.abs(s)>=60&&(o="hour",s/=60,Math.abs(s)>=24&&(o="day",s/=24,Math.abs(s)>=30&&(o="month",s/=30,Math.abs(s)>=12&&(o="year",s/=12)))));try{return new Intl.RelativeTimeFormat(this.getLocation(),i).format(Math.round(s),o)}catch{}return""}relativeLimit(t,e,n,r,a,i,o){const s=u(t),l=n||new Date,f=new Date(l),g=new Date(l);return f.setDate(l.getDate()-e),g.setDate(l.getDate()+e),s>=f&&s<=g?this.relative(s,r,l):this.date(s,i,a,o)}month(t,e){try{return Intl.DateTimeFormat(this.getLocation(),{month:e||"long"}).format(u(t))}catch{}return""}months(t){const e=[{label:"",value:void 0}];try{const n=new Date,r=Intl.DateTimeFormat(this.getLocation(),{month:t||"long"});for(let a=0;a<12;a++)n.setMonth(a),e.push({label:r.format(n).replace(/^./,i=>i.toUpperCase()),value:a+1})}catch{}return e}weekday(t,e){try{return Intl.DateTimeFormat(this.getLocation(),{weekday:e||"long"}).format(u(t))}catch{}return""}weekdays(t){const e=[{label:"",value:void 0}];try{const n=new Date,r=Intl.DateTimeFormat(this.getLocation(),{weekday:t||"long"}),a=n.getDay()+(this.geo.firstDay==="Mo"?-1:1);n.setDate(n.getDate()-a);for(let i=0;i<7;i++)e.push({label:r.format(n).replace(/^./,o=>o.toUpperCase()),value:n.getDay()}),n.setDate(n.getDate()+1)}catch{}return e}time(t){return this.date(t,"time")}sort(t,e=(n,r)=>[n,r]){const n=new Intl.Collator(this.getLocation());return t.sort((r,a)=>n.compare(...e(r,a)))}numberObject(t){try{return new Intl.NumberFormat(this.getLocation(),t)}catch{}}dateOptions(t,e="short"){const n={};return["full","datetime","date",void 0,"year-month","year"].indexOf(t)!==-1&&(n.year="numeric"),["full","datetime","date",void 0,"year-month","month"].indexOf(t)!==-1&&(n.month=e),["full","datetime","date",void 0,"day"].indexOf(t)!==-1&&(n.day="2-digit"),t!==void 0&&(["full","datetime","time","hour-minute","hour"].indexOf(t)!==-1&&(n.hour="2-digit"),["full","datetime","time","hour-minute","minute"].indexOf(t)!==-1&&(n.minute="2-digit"),["full","time","second"].indexOf(t)!==-1&&(n.second="2-digit")),n}}const m={};exports.CacheItem=$;exports.GeoIntl=w;exports.toDate=u;
