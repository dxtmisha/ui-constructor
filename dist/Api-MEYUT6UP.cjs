"use strict";var F=Object.defineProperty;var G=(n,t,s)=>t in n?F(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var d=(n,t,s)=>(G(n,typeof t!="symbol"?t+"":t,s),s);const l=require("./toArray-h-YFi-Q9.cjs"),u=require("./isFilled-D1Z5OZVG.cjs"),a=require("./Geo-DKCn6cDx.cjs"),j=require("./DataStorage-Bad5dLlo.cjs"),b=require("./executeFunction-HIcLkt3C.cjs");function y(n,t="=",s="&"){return l.forEach(n,(r,e)=>`${e}${t}${encodeURIComponent(String(r).trim())}`).sort().join(s)}var T=(n=>(n.get="GET",n.post="POST",n.put="PUT",n.delete="DELETE",n))(T||{});const i=class i{static isLocalhost(){return typeof location>"u"||location.hostname==="localhost"}static getHeaders(t,s="application/json;charset=UTF-8"){if(t!==null){const r={...t||{}};return s&&(r["Content-Type"]=s),r}}static getUrl(t){return`${this.url}${t}`.replace("{locale}",a.Geo.getLocation()).replace("{country}",a.Geo.getCountry()).replace("{language}",a.Geo.getLanguage())}static getBody(t={},s="GET"){if(s!=="GET"&&u.isFilled(t))return t instanceof FormData||a.isString(t)?t:JSON.stringify(t)}static getBodyForGet(t,s="",r="GET"){if(r==="GET"){const e=s.match(/\?/)?"&":"?",o=typeof t=="object"?y(t):t;if(u.isFilled(o))return`${e}${o}`}return""}static setUrl(t){return this.url=t,i}static async request(t){return a.isString(t)?await this.fetch({path:t}):await this.fetch(t)}static get(t){return this.request({...t,method:"GET"})}static post(t){return this.request({...t,method:"POST"})}static put(t){return this.request({...t,method:"PUT"})}static delete(t){return this.request({...t,method:"DELETE"})}static addResponse(t){return this.response.push(...l.toArray(t)),i}static getResponse(t="",s,r){return this.response.find(e=>{if((e==null?void 0:e.disable)!==!0&&t===e.path&&s===e.method){if(r===(e==null?void 0:e.request))return!0;if(u.isFilled(r)&&u.isFilled(e.request)&&l.isObjectNotArray(r)&&l.isObjectNotArray(e.request)&&!(r instanceof FormData)&&!(e.request instanceof FormData)&&Object.values(r).length===Object.values(e.request).length)return Object.entries(e.request).reduce((o,[h,g])=>o&&g===(r==null?void 0:r[h]),!0)}return!1})}static async fetch({path:t="",pathFull:s=void 0,method:r="GET",request:e=void 0,headers:o={},type:h="application/json;charset=UTF-8",init:g={}}){const p=this.getResponse(t,r,e);if(p)return b.executeFunction(p.response);try{const c=s??this.getUrl(t),E=`${c}${this.getBodyForGet(e,c,r)}`;return await(await fetch(E,{...g,method:r,headers:this.getHeaders(o,h),body:this.getBody(e,r)})).json()}catch(c){console.error(c)}return{}}};d(i,"url",j.useEnv("api","/")),d(i,"response",[]);let f=i;exports.Api=f;exports.ApiMethodItem=T;exports.getRequestString=y;
